!function(){"use strict";angular.module("tutobot",[]).directive("tutobotStep",function(t,e){return{restrict:"A",replace:!0,template:"",scope:{tutobotStep:"@tutobotStep"},controller:function(t,e,o){t.visible=!1,t.tutobot=e,t.$watch("tutobot.index",function(e,n){e!=n&&(t.step=t.tutobot.getCurrent(),t.tutobot.overlay&&(o.removeClass("tutobot-active-element"),angular.element(t.step.element).addClass("tutobot-active-element")))}),t.step=t.tutobot.getCurrent(),t.tutobot.overlay&&(o.removeClass("tutobot-active-element"),angular.element(t.step.element).addClass("tutobot-active-element")),t.getStyle=function(){return t.tutobot.computePlacement()}},link:function(o,n){if(angular.element(window).on("resize",function(){e(function(){o.tutobot.get(o.tutobotStep).forEach(function(t){t.offset=o.tutobot.getOffset(n[0])})},1)}),angular.element(window).on("scroll",function(){e(function(){o.tutobot.get(o.tutobotStep).forEach(function(t){t.offset=o.tutobot.getOffset(n[0])})},1)}),o.tutobot.get(o.tutobotStep).forEach(function(t){t.offset=o.tutobot.getOffset(n[0]),t.element=n[0]}),console.log(o.tutobot.steps),!o.tutobot.installed){var s='<div class="tutobot" ng-style="getStyle()" ng-class="tutobot.getCurrent().position"><div class="content">{{step.content}}</div><button ng-if="tutobot.canBefore" ng-click="tutobot.before()">before</button><button ng-if="tutobot.canNext" ng-click="tutobot.next()">next</button></div>';o.tutobot.overlay&&(s+='<div class="tutobot-overlay"></div>');var i=t(s),u=i(o);n.parent().append(u),o.tutobot.element=n[0].parentNode.querySelector(".tutobot"),o.tutobot.installed=!0}}}}).service("tutobotService",function(){this.installed=!1,this.steps=new Map,this.stepNames=[],this.index=0,this.canBefore=!1,this.canNext=!0,this.element=null,this.getOffset=function(t){return t=t.getBoundingClientRect(),{left:t.left+window.scrollX,top:t.top+window.scrollY,bottom:t.bottom+window.scrollY,right:t.right+window.scrollX,height:t.height,width:t.width}},this.computePlacement=function(){var t=this.getCurrent(),e=this.getOffset(this.element);switch(t.position){case"top-left":return{left:t.offset.left-e.width+"px",top:t.offset.top+"px"};case"top-right":return{left:t.offset.left+t.offset.width+"px",top:t.offset.top+"px"};case"bottom-left":return{left:t.offset.left-e.width+"px",top:t.offset.top+t.offset.height-e.height+"px"};case"bottom-right":return{left:t.offset.left+t.offset.width+"px",top:t.offset.top+t.offset.height-e.height+"px"}}},this.add=function(t){var e=this.steps.get(t.name);"undefined"==typeof e?(this.steps.set(t.name,[t]),this.stepNames.push(t.name)):(e.push(t),this.steps.set(t.name,e))},this.getCurrent=function(){return this.get(this.stepNames[this.index])[0]},this.get=function(t){return this.steps.get(t)},this.before=function(){this.index-1<0?this.index=0:this.index--,this.canBefore=this.index>0,this.canNext=this.index<this.stepNames.length-1},this.next=function(){this.index+1>=this.stepNames.length?this.index=this.stepNames.length-1:this.index++,this.canBefore=this.index>0,this.canNext=this.index<this.stepNames.length-1}})}();